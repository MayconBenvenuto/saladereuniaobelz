<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Imagens - Belz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-image {
            max-width: 200px;
            height: auto;
            margin: 10px 0;
            border: 1px solid #ccc;
        }
        .success { color: green; }
        .error { color: red; }
        .loading { color: orange; }
    </style>
</head>
<body>
    <h1>🧪 Teste de Carregamento de Imagens - Belz</h1>
    
    <div class="test-section">
        <h2>Logo Belz</h2>
        <img src="/logo-belz.png" alt="Logo Belz" class="test-image" id="logo-test">
        <p id="logo-status" class="loading">Carregando...</p>
    </div>
    
    <div class="test-section">
        <h2>Sala de Reunião</h2>
        <img src="/sala.jpg" alt="Sala de Reunião" class="test-image" id="sala-test">
        <p id="sala-status" class="loading">Carregando...</p>
    </div>
    
    <div class="test-section">
        <h2>Informações do Service Worker</h2>
        <p id="sw-status">Verificando Service Worker...</p>
        <p id="cache-status">Verificando cache...</p>
    </div>

    <script>
        // Testar carregamento das imagens
        function testImage(imgId, statusId, imageName) {
            const img = document.getElementById(imgId);
            const status = document.getElementById(statusId);
            
            img.onload = function() {
                status.innerHTML = `✅ ${imageName} carregou com sucesso!`;
                status.className = 'success';
            };
            
            img.onerror = function() {
                status.innerHTML = `❌ Erro ao carregar ${imageName}`;
                status.className = 'error';
            };
        }
        
        // Testar Service Worker
        function testServiceWorker() {
            const swStatus = document.getElementById('sw-status');
            const cacheStatus = document.getElementById('cache-status');
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations()
                    .then(registrations => {
                        if (registrations.length > 0) {
                            swStatus.innerHTML = `✅ Service Worker ativo: ${registrations.length} registrado(s)`;
                            swStatus.className = 'success';
                        } else {
                            swStatus.innerHTML = '❌ Nenhum Service Worker encontrado';
                            swStatus.className = 'error';
                        }
                    });
                
                // Testar cache
                if ('caches' in window) {
                    caches.keys()
                        .then(cacheNames => {
                            const belzCaches = cacheNames.filter(name => name.includes('belz'));
                            if (belzCaches.length > 0) {
                                cacheStatus.innerHTML = `✅ Cache encontrado: ${belzCaches.join(', ')}`;
                                cacheStatus.className = 'success';
                                
                                // Verificar conteúdo do cache
                                return caches.open(belzCaches[0]);
                            } else {
                                cacheStatus.innerHTML = '❌ Nenhum cache Belz encontrado';
                                cacheStatus.className = 'error';
                            }
                        })
                        .then(cache => {
                            if (cache) {
                                return cache.keys();
                            }
                        })
                        .then(keys => {
                            if (keys) {
                                const imageKeys = keys.map(key => key.url).filter(url => 
                                    url.includes('sala.jpg') || url.includes('logo-belz.png')
                                );
                                if (imageKeys.length > 0) {
                                    cacheStatus.innerHTML += `<br>🗂️ Imagens em cache: ${imageKeys.length}`;
                                }
                            }
                        });
                }
            } else {
                swStatus.innerHTML = '❌ Service Worker não suportado';
                swStatus.className = 'error';
            }
        }
        
        // Executar testes
        testImage('logo-test', 'logo-status', 'Logo');
        testImage('sala-test', 'sala-status', 'Sala de Reunião');
        testServiceWorker();
        
        // Recarregar página automaticamente após 30 segundos para testar cache
        setTimeout(() => {
            console.log('Recarregando para testar cache...');
            location.reload();
        }, 30000);
    </script>
</body>
</html>
