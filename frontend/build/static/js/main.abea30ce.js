(()=>{"use strict";var e={625:(e,t,n)=>{var a=n(950),i=n(352),r=n(555);const o={API_BASE_URL:"",API_TIMEOUT:15e3,API_RETRY_TIMEOUT:2e4,CACHE_DURATION:3e5,CACHE_DURATION_OFFLINE:18e5,MAX_RETRIES:3,RETRY_DELAY:1e3,DEBUG:!1},s=function(){if(o.DEBUG){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("[DEBUG]",...t)}},l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error("[ERROR]",...t)},c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("[WARN]",...t)};class d{constructor(){this.isOnline=navigator.onLine,this.retryCount=0,this.maxRetries=5,this.retryDelay=1e3,this.callbacks={online:[],offline:[],error:[]},this.init()}init(){window.addEventListener("online",this.handleOnline.bind(this)),window.addEventListener("offline",this.handleOffline.bind(this)),this.startHealthCheck()}handleOnline(){this.isOnline=!0,this.retryCount=0,s("Conex\xe3o reestabelecida"),this.notify("online")}handleOffline(){this.isOnline=!1,c("Conex\xe3o perdida"),this.notify("offline")}async healthCheck(){try{const e=fetch("".concat(o.API_BASE_URL,"/api/health"),{method:"GET",cache:"no-cache"}),t=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Health check timeout"))),1e4)})),n=await Promise.race([e,t]);if(n.ok)return this.isOnline||this.handleOnline(),!0;throw new Error("Health check failed: ".concat(n.status))}catch(e){return l("Health check error:",e),this.isOnline&&this.handleOffline(),!1}}startHealthCheck(){setInterval((()=>{this.isOnline&&this.healthCheck()}),3e4)}async retryOperation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maxRetries;for(let a=0;a<t;a++)try{const t=await e();return this.retryCount=0,t}catch(n){if(this.retryCount++,c("Tentativa ".concat(a+1,"/").concat(t," falhou:"),n.message),a===t-1)throw this.notify("error",n),n;const e=this.retryDelay*Math.pow(2,a);await new Promise((t=>setTimeout(t,e)))}}on(e,t){this.callbacks[e]&&this.callbacks[e].push(t)}off(e,t){if(this.callbacks[e]){const n=this.callbacks[e].indexOf(t);n>-1&&this.callbacks[e].splice(n,1)}}notify(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.callbacks[e]&&this.callbacks[e].forEach((e=>e(t)))}getStatus(){return{isOnline:this.isOnline,retryCount:this.retryCount,maxRetries:this.maxRetries}}}const m=new d;var h=n(414);const u=()=>navigator.onLine,p="meeting_room_cache",g=e=>{const[t,n]=e.split(":").map(Number);return 60*t+n},f=e=>{let{isOpen:t,onClose:n,selectedSlot:i,onConfirm:o}=e;const[s,l]=(0,a.useState)({name:"",title:"",participants:"",start_time:"",end_time:""});(0,a.useEffect)((()=>{i&&t&&l((e=>(0,r.A)((0,r.A)({},e),{},{start_time:i.start_time,end_time:i.end_time})))}),[i,t]);return t&&i?(0,h.jsx)("div",{className:"modal-overlay",children:(0,h.jsxs)("div",{className:"modal-content",children:[(0,h.jsxs)("div",{className:"modal-header",children:[(0,h.jsx)("h3",{children:"Agendar Reuni\xe3o"}),(0,h.jsx)("button",{className:"close-button",onClick:n,children:"\xd7"})]}),(0,h.jsxs)("div",{className:"booking-form",children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Hor\xe1rio Selecionado"}),(0,h.jsxs)("div",{style:{padding:"0.8rem",background:"#e8f5e8",borderRadius:"8px",fontWeight:"600",color:"#2d5a3d"},children:[i.start_time," - ",i.end_time]})]}),(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s.name.trim()?s.title.trim()?s.start_time&&s.end_time?s.start_time>=s.end_time?alert("Hor\xe1rio de fim deve ser posterior ao hor\xe1rio de in\xedcio"):o({name:s.name.trim(),title:s.title.trim(),participants:s.participants.trim(),start_time:s.start_time,end_time:s.end_time}):alert("Hor\xe1rios s\xe3o obrigat\xf3rios"):alert("T\xedtulo da reuni\xe3o \xe9 obrigat\xf3rio"):alert("Nome \xe9 obrigat\xf3rio")},children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Nome do Respons\xe1vel *"}),(0,h.jsx)("input",{type:"text",value:s.name,onChange:e=>l((t=>(0,r.A)((0,r.A)({},t),{},{name:e.target.value}))),required:!0,placeholder:"Digite seu nome"})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"T\xedtulo da Reuni\xe3o *"}),(0,h.jsx)("input",{type:"text",value:s.title,onChange:e=>l((t=>(0,r.A)((0,r.A)({},t),{},{title:e.target.value}))),required:!0,placeholder:"Ex: Reuni\xe3o de Vendas"})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Participantes"}),(0,h.jsx)("textarea",{value:s.participants,onChange:e=>l((t=>(0,r.A)((0,r.A)({},t),{},{participants:e.target.value}))),placeholder:"Lista de participantes (opcional)",rows:"3"})]}),(0,h.jsxs)("div",{className:"form-row",children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Hor\xe1rio de In\xedcio *"}),(0,h.jsx)("input",{type:"time",value:s.start_time,onChange:e=>l((t=>(0,r.A)((0,r.A)({},t),{},{start_time:e.target.value}))),required:!0})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Hor\xe1rio de T\xe9rmino *"}),(0,h.jsx)("input",{type:"time",value:s.end_time,onChange:e=>l((t=>(0,r.A)((0,r.A)({},t),{},{end_time:e.target.value}))),required:!0})]})]}),(0,h.jsxs)("div",{className:"form-actions",children:[(0,h.jsx)("button",{type:"button",onClick:n,className:"cancel-button",children:"Cancelar"}),(0,h.jsx)("button",{type:"submit",className:"submit-button",children:"Confirmar Agendamento"})]})]})]})]})}):null},v=()=>{const[e,t]=(0,a.useState)(new Date),[n,i]=(0,a.useState)([]),[d,v]=(0,a.useState)(!1),[x,j]=(0,a.useState)(null),[y,b]=(0,a.useState)(null),{loading:_,error:E,request:N,setError:S}=(()=>{const[e,t]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),[d,h]=(0,a.useState)("online");(0,a.useEffect)((()=>{const e=()=>{h("online"),i(null)},t=()=>{h("offline"),i("Sem conex\xe3o com a internet")},n=e=>{h("error"),i((null===e||void 0===e?void 0:e.message)||"Erro de conex\xe3o")};return m.on("online",e),m.on("offline",t),m.on("error",n),()=>{m.off("online",e),m.off("offline",t),m.off("error",n)}}),[]);const u=(0,a.useCallback)((async function(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.MAX_RETRIES;for(let d=0;d<l;d++)try{const n=o.API_TIMEOUT+5e3*d;s("Fazendo requisi\xe7\xe3o para: ".concat(e," (tentativa ").concat(d+1,"/").concat(l,") - timeout: ").concat(n,"ms"));const c=fetch(e,(0,r.A)((0,r.A)({},a),{},{mode:"cors",credentials:"include",headers:(0,r.A)({"Content-Type":"application/json",Accept:"application/json"},a.headers)})),m=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Timeout de ".concat(n,"ms excedido")))),n)})),h=await Promise.race([c,m]);if(h.ok)return s("Sucesso na requisi\xe7\xe3o para: ".concat(e)),i(null),h;if(h.status>=400&&h.status<500)throw new Error("Erro ".concat(h.status,": ").concat(h.statusText));t=new Error("Erro ".concat(h.status,": ").concat(h.statusText))}catch(n){if(t=n,n.message.includes("Timeout"),c("Tentativa ".concat(d+1,"/").concat(l," - ").concat(n.message)),d<l-1){const e=o.RETRY_DELAY*Math.pow(2,d);await new Promise((t=>setTimeout(t,e)))}}throw t}),[]),p=(0,a.useCallback)((async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(!0),i(null);try{const t=await u(e,a);return await t.json()}catch(n){throw l("Erro na requisi\xe7\xe3o:",n),i(n.message),n}finally{t(!1)}}),[u]);return{loading:e,error:n,request:p,fetchWithRetry:u,setError:i,setLoading:t,connectionStatus:d,isOnline:"online"===d}})(),A=e=>e.toISOString().split("T")[0],w=e=>{S(e)},C=(0,a.useMemo)((()=>function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;const a=[];for(let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;i<t;i++)for(let t=0;t<60;t+=n){const r="".concat(String(i).padStart(2,"0"),":").concat(String(t).padStart(2,"0")),o=t+n;let s=i,l=o;o>=60&&(s++,l=o-60);const c="".concat(String(s).padStart(2,"0"),":").concat(String(l).padStart(2,"0")),d=e.find((e=>{const t=g(r),n=g(c),a=g(e.start_time),i=g(e.end_time);return t>=a&&t<i||n>a&&n<=i||t<=a&&n>=i}));a.push({start_time:r,end_time:c,available:!d,appointment:d||null})}return a}(n)),[n]),O=(0,a.useCallback)((async()=>{const t=A(e),n=(e=>{try{const t=localStorage.getItem("".concat(p,"_").concat(e));if(t){const{data:e,timestamp:n}=JSON.parse(t),a=u()?o.CACHE_DURATION:o.CACHE_DURATION_OFFLINE;if(Date.now()-n<a)return e}}catch(t){console.warn("Erro ao ler cache:",t)}return null})(t);if(n)return i(n),void s("Dados carregados do cache para:",t);try{s("Carregando agendamentos para: ".concat(t));const e=await N("".concat(o.API_BASE_URL,"/api/appointments?date=").concat(t),{method:"GET"});s("Dados recebidos para ".concat(t,":"),e);const n=Array.isArray(e)?e:[];i(n),((e,t)=>{try{localStorage.setItem("".concat(p,"_").concat(e),JSON.stringify({data:t,timestamp:Date.now()}))}catch(n){console.warn("Erro ao salvar cache:",n)}})(t,n)}catch(E){l("Erro ao carregar agendamentos:",E);const n=localStorage.getItem("".concat(p,"_").concat(t));if(n)try{const{data:e}=JSON.parse(n);i(e||[]),w("Usando dados em cache (pode estar desatualizado).")}catch(a){i([]),w("Erro de conex\xe3o. N\xe3o foi poss\xedvel carregar os dados.")}else i([]),w("Erro de conex\xe3o. Tente novamente.")}}),[e,N]);(0,a.useEffect)((()=>{O()}),[O]);const T=n=>{const a=new Date(e);a.setDate(a.getDate()+n),t(a)};return(0,h.jsxs)("div",{className:"app",children:[(0,h.jsx)("div",{className:"header",children:(0,h.jsxs)("div",{className:"header-content",children:[(0,h.jsxs)("div",{className:"logo-container",children:[(0,h.jsx)("img",{src:"/logo-belz.png",alt:"Belz Logo",className:"logo",onError:e=>{e.target.style.display="none"}}),(0,h.jsx)("h1",{children:"Sistema de Agendamento"})]}),(0,h.jsx)("div",{className:"room-image-container",children:(0,h.jsxs)("div",{className:"room-overlay",children:[(0,h.jsx)("h2",{children:"Sala de Reuni\xe3o"}),(0,h.jsx)("p",{children:"Agendamento inteligente com hor\xe1rios flex\xedveis"})]})})]})}),(0,h.jsxs)("div",{className:"main-content",children:[!u()&&(0,h.jsx)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:"\u26a0\ufe0f Modo offline - Dados podem estar desatualizados"}),(0,h.jsxs)("div",{className:"date-navigation",children:[(0,h.jsx)("button",{className:"nav-button",onClick:()=>T(-1),disabled:_,children:"\u2039"}),(0,h.jsxs)("div",{className:"current-date",children:[(0,h.jsx)("h2",{children:(R=e,R.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}),(0,h.jsx)("input",{type:"date",value:A(e),onChange:e=>t(new Date(e.target.value+"T00:00:00")),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"8px",fontSize:"1rem"}})]}),(0,h.jsx)("button",{className:"nav-button",onClick:()=>T(1),disabled:_,children:"\u203a"})]}),_&&(0,h.jsxs)("div",{className:"loading",children:[(0,h.jsx)("div",{className:"spinner"}),"Carregando agendamentos..."]}),E&&(0,h.jsxs)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:[(0,h.jsxs)("span",{children:["\u26a0\ufe0f ",E]}),(0,h.jsx)("button",{onClick:()=>S(null),children:"\xd7"})]}),y&&(0,h.jsx)("div",{className:"notification success",style:{position:"relative",marginBottom:"1rem"},children:(0,h.jsxs)("span",{children:["\u2705 ",y]})}),(0,h.jsx)("div",{className:"calendar-container",children:(0,h.jsx)("div",{className:"time-slots",children:C.map(((e,t)=>(0,h.jsxs)("div",{className:"time-slot ".concat(e.available?"available":"occupied"),onClick:()=>(e=>{e.available&&(j(e),v(!0))})(e),children:[(0,h.jsxs)("div",{className:"time-range",children:[e.start_time," - ",e.end_time]}),e.available?(0,h.jsx)("div",{className:"slot-status",children:"Dispon\xedvel"}):(0,h.jsxs)("div",{className:"appointment-info",children:[(0,h.jsx)("div",{className:"appointment-title",children:e.appointment.title}),(0,h.jsx)("div",{className:"appointment-name",children:e.appointment.name})]})]},t)))})}),n.length>0&&(0,h.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,h.jsxs)("h3",{style:{marginBottom:"1rem",color:"#2a5298"},children:["Agendamentos do Dia (",n.length,")"]}),(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:n.map((e=>(0,h.jsxs)("div",{style:{background:"white",padding:"1rem",borderRadius:"8px",border:"1px solid #ddd",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,h.jsx)("h4",{style:{margin:"0 0 0.5rem 0",color:"#2a5298"},children:e.title}),(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Hor\xe1rio:"})," ",e.start_time," - ",e.end_time]}),(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.name]}),e.participants&&(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Participantes:"})," ",e.participants]}),e.description&&(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",e.description]})]},e.id)))})]})]}),(0,h.jsx)(f,{isOpen:d,onClose:()=>{v(!1),j(null)},selectedSlot:x,onConfirm:async t=>{try{const n={name:t.name,title:t.title,participants:t.participants,date:A(e),start_time:t.start_time,end_time:t.end_time};s("Criando agendamento:",n),await N("".concat(o.API_BASE_URL,"/api/appointments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),b("Agendamento criado com sucesso!"),setTimeout((()=>b(null)),3e3),v(!1),j(null),await O(),localStorage.removeItem("".concat(p,"_").concat(A(e)))}catch(E){l("Erro ao criar agendamento:",E),w("Erro ao criar agendamento. Tente novamente.")}}})]});var R};i.createRoot(document.getElementById("root")).render((0,h.jsx)(a.StrictMode,{children:(0,h.jsx)(v,{})}))}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.m=e,(()=>{var e=[];n.O=(t,a,i,r)=>{if(!a){var o=1/0;for(d=0;d<e.length;d++){a=e[d][0],i=e[d][1],r=e[d][2];for(var s=!0,l=0;l<a.length;l++)(!1&r||o>=r)&&Object.keys(n.O).every((e=>n.O[e](a[l])))?a.splice(l--,1):(s=!1,r<o&&(o=r));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,i,r]}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var i,r,o=a[0],s=a[1],l=a[2],c=0;if(o.some((t=>0!==e[t]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)var d=l(n)}for(t&&t(a);c<o.length;c++)r=o[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},a=self.webpackChunkfrontend=self.webpackChunkfrontend||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=n.O(void 0,[103],(()=>n(625)));a=n.O(a)})();