(()=>{"use strict";var e={625:(e,t,a)=>{var n=a(950),o=a(352),r=a(555);const i={API_BASE_URL:"undefined"!==typeof window?window.location.origin:"",API_TIMEOUT:12e3,API_RETRY_TIMEOUT:18e3,CACHE_DURATION:18e4,CACHE_DURATION_OFFLINE:18e5,MAX_RETRIES:2,RETRY_DELAY:1e3,DEBOUNCE_DELAY:300,PREFETCH_NEXT_DAY:!0,DEBUG:!1},s=function(){if(i.DEBUG){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.log("[DEBUG]",...t)}},c=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.error("[ERROR]",...t)},l=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.warn("[WARN]",...t)};"undefined"!==typeof window&&(console.log("[CONFIG] Environment:","production"),console.log("[CONFIG] API Base URL:",i.API_BASE_URL),console.log("[CONFIG] Current Origin:",window.location.origin));class d{constructor(){this.isOnline=navigator.onLine,this.retryCount=0,this.maxRetries=5,this.retryDelay=1e3,this.callbacks={online:[],offline:[],error:[]},this.init()}init(){window.addEventListener("online",this.handleOnline.bind(this)),window.addEventListener("offline",this.handleOffline.bind(this)),this.startHealthCheck()}handleOnline(){this.isOnline=!0,this.retryCount=0,s("Conex\xe3o reestabelecida"),this.notify("online")}handleOffline(){this.isOnline=!1,l("Conex\xe3o perdida"),this.notify("offline")}async healthCheck(){try{const e="".concat(i.API_BASE_URL,"/api/health");s("Fazendo health check para: ".concat(e));const t=fetch(e,{method:"GET",cache:"no-cache"}),a=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Health check timeout"))),15e3)})),n=await Promise.race([t,a]);if(n.ok)return this.isOnline||this.handleOnline(),!0;throw new Error("Health check failed: ".concat(n.status))}catch(e){return c("Health check error:",e),this.isOnline&&this.handleOffline(),!1}}startHealthCheck(){console.log("[ConnectionMonitor] Health check autom\xe1tico desabilitado temporariamente")}async retryOperation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maxRetries;for(let n=0;n<t;n++)try{const t=await e();return this.retryCount=0,t}catch(a){if(this.retryCount++,l("Tentativa ".concat(n+1,"/").concat(t," falhou:"),a.message),n===t-1)throw this.notify("error",a),a;const e=this.retryDelay*Math.pow(2,n);await new Promise((t=>setTimeout(t,e)))}}on(e,t){this.callbacks[e]&&this.callbacks[e].push(t)}off(e,t){if(this.callbacks[e]){const a=this.callbacks[e].indexOf(t);a>-1&&this.callbacks[e].splice(a,1)}}notify(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.callbacks[e]&&this.callbacks[e].forEach((e=>e(t)))}getStatus(){return{isOnline:this.isOnline,retryCount:this.retryCount,maxRetries:this.maxRetries}}}const m=new d;var h=a(414);const u=()=>navigator.onLine,p="meeting_room_cache",g=e=>{if(!e)return 0;const t=e.split(":");return 60*(parseInt(t[0])||0)+(parseInt(t[1])||0)},f=e=>{let{isOpen:t,onClose:a,selectedSlot:o,onConfirm:i}=e;const[s,c]=(0,n.useState)({name:"",title:"",participants:"",start_time:"",end_time:""});(0,n.useEffect)((()=>{o&&t&&c((e=>(0,r.A)((0,r.A)({},e),{},{start_time:o.start_time,end_time:o.end_time})))}),[o,t]);return t&&o?(0,h.jsx)("div",{className:"modal-overlay",children:(0,h.jsxs)("div",{className:"modal-content",children:[(0,h.jsxs)("div",{className:"modal-header",children:[(0,h.jsx)("h3",{children:"Agendar Reuni\xe3o"}),(0,h.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,h.jsxs)("div",{className:"booking-form",children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Hor\xe1rio Selecionado"}),(0,h.jsxs)("div",{style:{padding:"0.8rem",background:"#e8f5e8",borderRadius:"8px",fontWeight:"600",color:"#2d5a3d"},children:[o.start_time," - ",o.end_time]})]}),(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s.name.trim()?s.title.trim()?s.start_time&&s.end_time?s.start_time>=s.end_time?alert("Hor\xe1rio de fim deve ser posterior ao hor\xe1rio de in\xedcio"):i({name:s.name.trim(),title:s.title.trim(),participants:s.participants.trim(),start_time:s.start_time,end_time:s.end_time}):alert("Hor\xe1rios s\xe3o obrigat\xf3rios"):alert("T\xedtulo da reuni\xe3o \xe9 obrigat\xf3rio"):alert("Nome \xe9 obrigat\xf3rio")},children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Nome do Respons\xe1vel *"}),(0,h.jsx)("input",{type:"text",value:s.name,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{name:e.target.value}))),required:!0,placeholder:"Digite seu nome"})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"T\xedtulo da Reuni\xe3o *"}),(0,h.jsx)("input",{type:"text",value:s.title,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{title:e.target.value}))),required:!0,placeholder:"Ex: Reuni\xe3o de Vendas"})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Participantes"}),(0,h.jsx)("textarea",{value:s.participants,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{participants:e.target.value}))),placeholder:"Lista de participantes (opcional)",rows:"3"})]}),(0,h.jsxs)("div",{className:"form-row",children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Hor\xe1rio de In\xedcio *"}),(0,h.jsx)("input",{type:"time",value:s.start_time,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{start_time:e.target.value}))),required:!0})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Hor\xe1rio de T\xe9rmino *"}),(0,h.jsx)("input",{type:"time",value:s.end_time,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{end_time:e.target.value}))),required:!0})]})]}),(0,h.jsxs)("div",{className:"form-actions",children:[(0,h.jsx)("button",{type:"button",onClick:a,className:"cancel-button",children:"Cancelar"}),(0,h.jsx)("button",{type:"submit",className:"submit-button",children:"Confirmar Agendamento"})]})]})]})]})}):null},v=()=>{const[e,t]=(0,n.useState)(new Date),[a,o]=(0,n.useState)([]),[d,v]=(0,n.useState)(!1),[x,j]=(0,n.useState)(null),[y,_]=(0,n.useState)(null),[E,b]=(0,n.useState)({start_hour:8,end_hour:20,slot_duration:30}),{loading:A,error:C,request:w,setError:N}=(()=>{const[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(null),[d,h]=(0,n.useState)("online");(0,n.useEffect)((()=>{const e=()=>{h("online"),o(null)},t=()=>{h("offline"),o("Sem conex\xe3o com a internet")},a=e=>{h("error"),o((null===e||void 0===e?void 0:e.message)||"Erro de conex\xe3o")};return m.on("online",e),m.on("offline",t),m.on("error",a),()=>{m.off("online",e),m.off("offline",t),m.off("error",a)}}),[]);const u=(0,n.useCallback)((async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MAX_RETRIES;for(let d=0;d<c;d++)try{const a=i.API_TIMEOUT+5e3*d;s("Fazendo requisi\xe7\xe3o para: ".concat(e," (tentativa ").concat(d+1,"/").concat(c,") - timeout: ").concat(a,"ms"));const l=fetch(e,(0,r.A)((0,r.A)({},n),{},{mode:"cors",credentials:"include",headers:(0,r.A)({"Content-Type":"application/json",Accept:"application/json"},n.headers)})),m=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Timeout de ".concat(a,"ms excedido")))),a)})),h=await Promise.race([l,m]);if(h.ok)return s("Sucesso na requisi\xe7\xe3o para: ".concat(e)),o(null),h;if(h.status>=400&&h.status<500)throw new Error("Erro ".concat(h.status,": ").concat(h.statusText));t=new Error("Erro ".concat(h.status,": ").concat(h.statusText))}catch(a){if(t=a,a.message.includes("Timeout"),l("Tentativa ".concat(d+1,"/").concat(c," - ").concat(a.message)),d<c-1){const e=i.RETRY_DELAY*Math.pow(2,d);await new Promise((t=>setTimeout(t,e)))}}throw t}),[]),p=(0,n.useCallback)((async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(!0),o(null);try{const t=await u(e,n);return await t.json()}catch(a){throw c("Erro na requisi\xe7\xe3o:",a),o(a.message),a}finally{t(!1)}}),[u]);return{loading:e,error:a,request:p,fetchWithRetry:u,setError:o,setLoading:t,connectionStatus:d,isOnline:"online"===d}})(),S=e=>e.toISOString().split("T")[0],O=e=>{N(e)},R=(0,n.useMemo)((()=>{const{start_hour:e,end_hour:t,slot_duration:n}=E;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;const o=[];console.log("[DEBUG] Gerando slots com agendamentos:",e);for(let r=t;r<a;r++)for(let t=0;t<60;t+=n){const a="".concat(String(r).padStart(2,"0"),":").concat(String(t).padStart(2,"0")),i=t+n;let s=r,c=i;i>=60&&(s++,c=i-60);const l="".concat(String(s).padStart(2,"0"),":").concat(String(c).padStart(2,"0")),d=e.find((e=>{const t=g(a),n=g(l),o=g(e.start_time),r=g(e.end_time);console.log("[DEBUG] Comparando slot ".concat(a,"-").concat(l," (").concat(t,"-").concat(n,") com agendamento ").concat(e.start_time,"-").concat(e.end_time," (").concat(o,"-").concat(r,")"));const i=t>=o&&t<r||n>o&&n<=r||t<=o&&n>=r;return i&&console.log("[DEBUG] \u2705 Conflito encontrado: slot ".concat(a,"-").concat(l,' ocupado por "').concat(e.title,'"')),i}));o.push({start_time:a,end_time:l,available:!d,appointment:d||null})}return console.log("[DEBUG] Slots gerados:",o.length,"total"),console.log("[DEBUG] Slots ocupados:",o.filter((e=>!e.available)).length),o}(a,e,t,n)}),[a,E]),T=(0,n.useCallback)((async()=>{const t=S(e);try{s("Carregando configura\xe7\xe3o de slots para: ".concat(t));const e=await w("".concat(i.API_BASE_URL,"/api/availability/").concat(t),{method:"GET"});e&&e.slots_config&&(b(e.slots_config),s("Configura\xe7\xe3o de slots atualizada:",e.slots_config))}catch(C){c("Erro ao carregar configura\xe7\xe3o de slots:",C)}}),[e,w]),D=(0,n.useCallback)((async()=>{const t=S(e),a=(e=>{try{const t=localStorage.getItem("".concat(p,"_").concat(e));if(t){const{data:e,timestamp:a}=JSON.parse(t),n=u()?i.CACHE_DURATION:i.CACHE_DURATION_OFFLINE;if(Date.now()-a<n)return e}}catch(t){console.warn("Erro ao ler cache:",t)}return null})(t);if(a)return o(a),void s("Dados carregados do cache para:",t);try{s("Carregando agendamentos para: ".concat(t));const e=await w("".concat(i.API_BASE_URL,"/api/appointments?date=").concat(t),{method:"GET"});s("Dados recebidos para ".concat(t,":"),e);const a=Array.isArray(e)?e:[];console.log("[DEBUG] Appointments processados:",a),o(a),((e,t)=>{try{localStorage.setItem("".concat(p,"_").concat(e),JSON.stringify({data:t,timestamp:Date.now()}))}catch(a){console.warn("Erro ao salvar cache:",a)}})(t,a)}catch(C){c("Erro ao carregar agendamentos:",C);const a=localStorage.getItem("".concat(p,"_").concat(t));if(a)try{const{data:e}=JSON.parse(a);o(e||[]),O("Usando dados em cache (pode estar desatualizado).")}catch(n){o([]),O("Erro de conex\xe3o. N\xe3o foi poss\xedvel carregar os dados.")}else o([]),O("Erro de conex\xe3o. Tente novamente.")}}),[e,w]);(0,n.useEffect)((()=>{T(),D()}),[T,D]);const k=a=>{const n=new Date(e);n.setDate(n.getDate()+a),t(n)};return(0,h.jsxs)("div",{className:"app",children:[(0,h.jsx)("div",{className:"header",children:(0,h.jsxs)("div",{className:"header-content",children:[(0,h.jsxs)("div",{className:"logo-container",children:[(0,h.jsx)("img",{src:"/logo-belz.png",alt:"Belz Logo",className:"logo",onError:e=>{e.target.style.display="none"}}),(0,h.jsx)("h1",{children:"Sistema de Agendamento"})]}),(0,h.jsx)("div",{className:"room-image-container",children:(0,h.jsxs)("div",{className:"room-overlay",children:[(0,h.jsx)("h2",{children:"Sala de Reuni\xe3o"}),(0,h.jsx)("p",{children:"Agendamento inteligente com hor\xe1rios flex\xedveis"})]})})]})}),(0,h.jsxs)("div",{className:"main-content",children:[!u()&&(0,h.jsx)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:"\u26a0\ufe0f Modo offline - Dados podem estar desatualizados"}),(0,h.jsxs)("div",{className:"date-navigation",children:[(0,h.jsx)("button",{className:"nav-button",onClick:()=>k(-1),disabled:A,children:"\u2039"}),(0,h.jsxs)("div",{className:"current-date",children:[(0,h.jsx)("h2",{children:(I=e,I.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}),(0,h.jsx)("input",{type:"date",value:S(e),onChange:e=>t(new Date(e.target.value+"T00:00:00")),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"8px",fontSize:"1rem"}})]}),(0,h.jsx)("button",{className:"nav-button",onClick:()=>k(1),disabled:A,children:"\u203a"})]}),A&&(0,h.jsxs)("div",{className:"loading",children:[(0,h.jsx)("div",{className:"spinner"}),"Carregando agendamentos..."]}),C&&(0,h.jsxs)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:[(0,h.jsxs)("span",{children:["\u26a0\ufe0f ",C]}),(0,h.jsx)("button",{onClick:()=>N(null),children:"\xd7"})]}),y&&(0,h.jsx)("div",{className:"notification success",style:{position:"relative",marginBottom:"1rem"},children:(0,h.jsxs)("span",{children:["\u2705 ",y]})}),a.length>0&&(0,h.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,h.jsxs)("h3",{style:{marginBottom:"1rem",color:"#2a5298"},children:["Agendamentos do Dia (",a.length,")"]}),(0,h.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:a.map((e=>(0,h.jsxs)("div",{style:{background:"white",padding:"1rem",borderRadius:"8px",border:"1px solid #ddd",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,h.jsx)("h4",{style:{margin:"0 0 0.5rem 0",color:"#2a5298"},children:e.title}),(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Hor\xe1rio:"})," ",e.start_time," - ",e.end_time]}),(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.name]}),e.participants&&(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Participantes:"})," ",e.participants]}),e.description&&(0,h.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,h.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",e.description]})]},e.id)))})]}),(0,h.jsx)("div",{className:"calendar-container",children:(0,h.jsx)("div",{className:"time-slots",children:R.map(((e,t)=>(0,h.jsxs)("div",{className:"time-slot ".concat(e.available?"available":"occupied"),onClick:()=>(e=>{e.available&&(j(e),v(!0))})(e),children:[(0,h.jsxs)("div",{className:"time-range",children:[e.start_time," - ",e.end_time]}),e.available?(0,h.jsx)("div",{className:"slot-status",children:"Dispon\xedvel"}):(0,h.jsxs)("div",{className:"appointment-info",children:[(0,h.jsx)("div",{className:"appointment-title",children:e.appointment.title}),(0,h.jsx)("div",{className:"appointment-name",children:e.appointment.name})]})]},t)))})})]}),(0,h.jsx)(f,{isOpen:d,onClose:()=>{v(!1),j(null)},selectedSlot:x,onConfirm:async t=>{try{const n={name:t.name,title:t.title,participants:t.participants,date:S(e),start_time:t.start_time,end_time:t.end_time};s("Criando agendamento:",n),await w("".concat(i.API_BASE_URL,"/api/appointments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),_("Agendamento criado com sucesso!"),setTimeout((()=>_(null)),3e3),v(!1),j(null);const r=S(e);localStorage.removeItem("".concat(p,"_").concat(r)),console.log("[DEBUG] Recarregando agendamentos ap\xf3s cria\xe7\xe3o...");try{const e=Date.now(),t=await w("".concat(i.API_BASE_URL,"/api/appointments?date=").concat(r,"&_cb=").concat(e),{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});console.log("[DEBUG] Dados frescos recebidos:",t);const a=Array.isArray(t)?t:[];o(a)}catch(a){console.error("[DEBUG] Erro ao recarregar, tentando m\xe9todo normal:",a),await D()}}catch(C){c("Erro ao criar agendamento:",C),O("Erro ao criar agendamento. Tente novamente.")}}})]});var I};o.createRoot(document.getElementById("root")).render((0,h.jsx)(n.StrictMode,{children:(0,h.jsx)(v,{})}))}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.m=e,(()=>{var e=[];a.O=(t,n,o,r)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],r=e[d][2];for(var s=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(s=!1,r<i&&(i=r));if(s){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]}})(),a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,i=n[0],s=n[1],c=n[2],l=0;if(i.some((t=>0!==e[t]))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(c)var d=c(a)}for(t&&t(n);l<i.length;l++)r=i[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self.webpackChunkfrontend=self.webpackChunkfrontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=a.O(void 0,[103],(()=>a(625)));n=a.O(n)})();