(()=>{"use strict";var e={218:(e,t,a)=>{var n=a(950),o=a(352),r=a(555);const s={API_BASE_URL:"undefined"!==typeof window?window.location.origin:"",API_TIMEOUT:8e3,API_RETRY_TIMEOUT:12e3,CACHE_DURATION:18e4,CACHE_DURATION_OFFLINE:18e5,MAX_RETRIES:2,RETRY_DELAY:1e3,DEBOUNCE_DELAY:300,PREFETCH_NEXT_DAY:!0,DEBUG:!0},i=function(){if(s.DEBUG){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.log("[DEBUG]",...t)}},c=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.error("[ERROR]",...t)},l=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.warn("[WARN]",...t)};"undefined"!==typeof window&&(console.log("[CONFIG] Environment:","production"),console.log("[CONFIG] API Base URL:",s.API_BASE_URL),console.log("[CONFIG] Current Origin:",window.location.origin));var d=a(414);const m=()=>navigator.onLine,u="meeting_room_cache",p=e=>{if(!e)return 0;const t=e.split(":");return 60*(parseInt(t[0])||0)+(parseInt(t[1])||0)},g=e=>{let{isOpen:t,onClose:a,selectedSlot:o,onConfirm:s}=e;const[i,c]=(0,n.useState)({name:"",title:"",participants:"",start_time:"",end_time:""});(0,n.useEffect)((()=>{o&&t&&c((e=>(0,r.A)((0,r.A)({},e),{},{start_time:o.start_time,end_time:o.end_time})))}),[o,t]);return t&&o?(0,d.jsx)("div",{className:"modal-overlay",children:(0,d.jsxs)("div",{className:"modal-content",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h3",{children:"Agendar Reuni\xe3o"}),(0,d.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,d.jsxs)("div",{className:"booking-form",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Hor\xe1rio Selecionado"}),(0,d.jsxs)("div",{style:{padding:"0.8rem",background:"#e8f5e8",borderRadius:"8px",fontWeight:"600",color:"#2d5a3d"},children:[o.start_time," - ",o.end_time]})]}),(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i.name.trim()?i.title.trim()?i.start_time&&i.end_time?i.start_time>=i.end_time?alert("Hor\xe1rio de fim deve ser posterior ao hor\xe1rio de in\xedcio"):s({name:i.name.trim(),title:i.title.trim(),participants:i.participants.trim(),start_time:i.start_time,end_time:i.end_time}):alert("Hor\xe1rios s\xe3o obrigat\xf3rios"):alert("T\xedtulo da reuni\xe3o \xe9 obrigat\xf3rio"):alert("Nome \xe9 obrigat\xf3rio")},children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Nome do Respons\xe1vel *"}),(0,d.jsx)("input",{type:"text",value:i.name,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{name:e.target.value}))),required:!0,placeholder:"Digite seu nome"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"T\xedtulo da Reuni\xe3o *"}),(0,d.jsx)("input",{type:"text",value:i.title,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{title:e.target.value}))),required:!0,placeholder:"Ex: Reuni\xe3o de Vendas"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Participantes"}),(0,d.jsx)("textarea",{value:i.participants,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{participants:e.target.value}))),placeholder:"Lista de participantes (opcional)",rows:"3"})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Hor\xe1rio de In\xedcio *"}),(0,d.jsx)("input",{type:"time",value:i.start_time,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{start_time:e.target.value}))),required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Hor\xe1rio de T\xe9rmino *"}),(0,d.jsx)("input",{type:"time",value:i.end_time,onChange:e=>c((t=>(0,r.A)((0,r.A)({},t),{},{end_time:e.target.value}))),required:!0})]})]}),(0,d.jsxs)("div",{className:"form-actions",children:[(0,d.jsx)("button",{type:"button",onClick:a,className:"cancel-button",children:"Cancelar"}),(0,d.jsx)("button",{type:"submit",className:"submit-button",children:"Confirmar Agendamento"})]})]})]})]})}):null},h=()=>{const[e,t]=(0,n.useState)(new Date),[a,o]=(0,n.useState)([]),[h,v]=(0,n.useState)(!1),[f,x]=(0,n.useState)(null),[j,_]=(0,n.useState)(null),[E,y]=(0,n.useState)({start_hour:8,end_hour:20,slot_duration:30}),{loading:b,error:A,request:N,setError:w}=(()=>{const[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(null),[d,m]=(0,n.useState)("online");(0,n.useEffect)((()=>{const e=()=>{m("online"),o(null)},t=()=>{m("offline"),o("Sem conex\xe3o com a internet")};return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}),[]);const u=(0,n.useCallback)((async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.MAX_RETRIES;for(let d=0;d<c;d++)try{const a=0===d?s.API_TIMEOUT:s.API_RETRY_TIMEOUT;i("Fazendo requisi\xe7\xe3o para: ".concat(e," (tentativa ").concat(d+1,"/").concat(c,") - timeout: ").concat(a,"ms"));const l=fetch(e,(0,r.A)((0,r.A)({},n),{},{mode:"cors",credentials:"include",headers:(0,r.A)({"Content-Type":"application/json",Accept:"application/json"},n.headers)})),m=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Timeout de ".concat(a,"ms excedido")))),a)})),u=await Promise.race([l,m]);if(u.ok)return i("Sucesso na requisi\xe7\xe3o para: ".concat(e)),o(null),u;if(u.status>=400&&u.status<500)throw new Error("Erro ".concat(u.status,": ").concat(u.statusText));t=new Error("Erro ".concat(u.status,": ").concat(u.statusText))}catch(a){if(t=a,a.message.includes("Timeout"),l("Tentativa ".concat(d+1,"/").concat(c," - ").concat(a.message)),d<c-1){const e=s.RETRY_DELAY*Math.pow(2,d);await new Promise((t=>setTimeout(t,e)))}}throw t}),[]),p=(0,n.useCallback)((async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(!0),o(null);try{const t=await u(e,n);return await t.json()}catch(a){throw c("Erro na requisi\xe7\xe3o:",a),o(a.message),a}finally{t(!1)}}),[u]);return{loading:e,error:a,request:p,fetchWithRetry:u,setError:o,setLoading:t,connectionStatus:d,isOnline:"online"===d}})(),S=e=>e.toISOString().split("T")[0],C=e=>{w(e)},T=(0,n.useMemo)((()=>{const{start_hour:e,end_hour:t,slot_duration:n}=E;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;const o=[];console.log("[DEBUG] Gerando slots com agendamentos:",e);for(let r=t;r<a;r++)for(let t=0;t<60;t+=n){const a="".concat(String(r).padStart(2,"0"),":").concat(String(t).padStart(2,"0")),s=t+n;let i=r,c=s;s>=60&&(i++,c=s-60);const l="".concat(String(i).padStart(2,"0"),":").concat(String(c).padStart(2,"0")),d=e.find((e=>{const t=p(a),n=p(l),o=p(e.start_time),r=p(e.end_time);console.log("[DEBUG] Comparando slot ".concat(a,"-").concat(l," (").concat(t,"-").concat(n,") com agendamento ").concat(e.start_time,"-").concat(e.end_time," (").concat(o,"-").concat(r,")"));const s=t>=o&&t<r||n>o&&n<=r||t<=o&&n>=r;return s&&console.log("[DEBUG] \u2705 Conflito encontrado: slot ".concat(a,"-").concat(l,' ocupado por "').concat(e.title,'"')),s}));o.push({start_time:a,end_time:l,available:!d,appointment:d||null})}return console.log("[DEBUG] Slots gerados:",o.length,"total"),console.log("[DEBUG] Slots ocupados:",o.filter((e=>!e.available)).length),o}(a,e,t,n)}),[a,E]),R=(0,n.useCallback)((async()=>{const t=S(e);try{i("Carregando configura\xe7\xe3o de slots para: ".concat(t));const e=await N("".concat(s.API_BASE_URL,"/api/availability/").concat(t),{method:"GET"});e&&e.slots_config&&(y(e.slots_config),i("Configura\xe7\xe3o de slots atualizada:",e.slots_config))}catch(A){c("Erro ao carregar configura\xe7\xe3o de slots:",A)}}),[e,N]),D=(0,n.useCallback)((async()=>{const t=S(e),a=(e=>{try{const t=localStorage.getItem("".concat(u,"_").concat(e));if(t){const{data:e,timestamp:a}=JSON.parse(t),n=m()?s.CACHE_DURATION:s.CACHE_DURATION_OFFLINE;if(Date.now()-a<n)return e}}catch(t){console.warn("Erro ao ler cache:",t)}return null})(t);if(a)return o(a),void i("Dados carregados do cache para:",t);try{i("Carregando agendamentos para: ".concat(t));const e=await N("".concat(s.API_BASE_URL,"/api/appointments?date=").concat(t),{method:"GET"});i("Dados recebidos para ".concat(t,":"),e);const a=Array.isArray(e)?e:[];console.log("[DEBUG] Appointments processados:",a),o(a),((e,t)=>{try{localStorage.setItem("".concat(u,"_").concat(e),JSON.stringify({data:t,timestamp:Date.now()}))}catch(a){console.warn("Erro ao salvar cache:",a)}})(t,a)}catch(A){c("Erro ao carregar agendamentos:",A);const a=localStorage.getItem("".concat(u,"_").concat(t));if(a)try{const{data:e}=JSON.parse(a);o(e||[]),C("Usando dados em cache (pode estar desatualizado).")}catch(n){o([]),C("Erro de conex\xe3o. N\xe3o foi poss\xedvel carregar os dados.")}else o([]),C("Erro de conex\xe3o. Tente novamente.")}}),[e,N]);(0,n.useEffect)((()=>{R(),D()}),[R,D]),(0,n.useEffect)((()=>{console.log("Verificando acesso \xe0 imagem...")}),[]);const O=a=>{const n=new Date(e);n.setDate(n.getDate()+a),t(n)};return(0,d.jsxs)("div",{className:"app",children:[(0,d.jsx)("div",{className:"header",children:(0,d.jsx)("div",{className:"header-content",children:(0,d.jsxs)("div",{className:"logo-container",children:[(0,d.jsx)("img",{src:"/logo-belz.png",alt:"Belz Logo",className:"logo",onError:e=>{e.target.style.display="none"}}),(0,d.jsx)("h1",{children:"Agende sua Reuni\xe3o"})]})})}),(0,d.jsxs)("div",{className:"main-content",children:[!m()&&(0,d.jsx)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:"\u26a0\ufe0f Modo offline - Dados podem estar desatualizados"}),(0,d.jsxs)("div",{className:"date-navigation",children:[(0,d.jsx)("button",{className:"nav-button",onClick:()=>O(-1),disabled:b,children:"\u2039"}),(0,d.jsxs)("div",{className:"current-date",children:[(0,d.jsx)("h2",{children:(I=e,I.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}),(0,d.jsx)("input",{type:"date",value:S(e),onChange:e=>t(new Date(e.target.value+"T00:00:00")),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"8px",fontSize:"1rem"}})]}),(0,d.jsx)("button",{className:"nav-button",onClick:()=>O(1),disabled:b,children:"\u203a"})]}),b&&(0,d.jsxs)("div",{className:"loading",children:[(0,d.jsx)("div",{className:"spinner"}),"Carregando agendamentos..."]}),A&&(0,d.jsxs)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:[(0,d.jsxs)("span",{children:["\u26a0\ufe0f ",A]}),(0,d.jsx)("button",{onClick:()=>w(null),children:"\xd7"})]}),j&&(0,d.jsx)("div",{className:"notification success",style:{position:"relative",marginBottom:"1rem"},children:(0,d.jsxs)("span",{children:["\u2705 ",j]})}),a.length>0&&(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("h3",{style:{marginBottom:"1rem",color:"#2a5298"},children:["Agendamentos do Dia (",a.length,")"]}),(0,d.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:a.map((e=>(0,d.jsxs)("div",{style:{background:"white",padding:"1rem",borderRadius:"8px",border:"1px solid #ddd",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,d.jsx)("h4",{style:{margin:"0 0 0.5rem 0",color:"#2a5298"},children:e.title}),(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Hor\xe1rio:"})," ",e.start_time," - ",e.end_time]}),(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.name]}),e.participants&&(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Participantes:"})," ",e.participants]}),e.description&&(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",e.description]})]},e.id)))})]}),(0,d.jsx)("div",{className:"calendar-container",children:(0,d.jsx)("div",{className:"time-slots",children:T.map(((e,t)=>(0,d.jsxs)("div",{className:"time-slot ".concat(e.available?"available":"occupied"),onClick:()=>(e=>{e.available&&(x(e),v(!0))})(e),children:[(0,d.jsxs)("div",{className:"time-range",children:[e.start_time," - ",e.end_time]}),e.available?(0,d.jsx)("div",{className:"slot-status",children:"Dispon\xedvel"}):(0,d.jsxs)("div",{className:"appointment-info",children:[(0,d.jsx)("div",{className:"appointment-title",children:e.appointment.title}),(0,d.jsx)("div",{className:"appointment-name",children:e.appointment.name})]})]},t)))})})]}),(0,d.jsx)(g,{isOpen:h,onClose:()=>{v(!1),x(null)},selectedSlot:f,onConfirm:async t=>{try{const n={name:t.name,title:t.title,participants:t.participants,date:S(e),start_time:t.start_time,end_time:t.end_time};i("Criando agendamento:",n),await N("".concat(s.API_BASE_URL,"/api/appointments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),_("Agendamento criado com sucesso!"),setTimeout((()=>_(null)),3e3),v(!1),x(null);const r=S(e);localStorage.removeItem("".concat(u,"_").concat(r)),console.log("[DEBUG] Recarregando agendamentos ap\xf3s cria\xe7\xe3o...");try{const e=Date.now(),t=await N("".concat(s.API_BASE_URL,"/api/appointments?date=").concat(r,"&_cb=").concat(e),{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});console.log("[DEBUG] Dados frescos recebidos:",t);const a=Array.isArray(t)?t:[];o(a)}catch(a){console.error("[DEBUG] Erro ao recarregar, tentando m\xe9todo normal:",a),await D()}}catch(A){c("Erro ao criar agendamento:",A),C("Erro ao criar agendamento. Tente novamente.")}}})]});var I};o.createRoot(document.getElementById("root")).render((0,d.jsx)(n.StrictMode,{children:(0,d.jsx)(h,{})}))}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.m=e,(()=>{var e=[];a.O=(t,n,o,r)=>{if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],r=e[d][2];for(var i=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(i=!1,r<s&&(s=r));if(i){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]}})(),a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,s=n[0],i=n[1],c=n[2],l=0;if(s.some((t=>0!==e[t]))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(c)var d=c(a)}for(t&&t(n);l<s.length;l++)r=s[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self.webpackChunkfrontend=self.webpackChunkfrontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=a.O(void 0,[103],(()=>a(218)));n=a.O(n)})();