(()=>{"use strict";var e={147:(e,a,t)=>{var n=t(43),o=t(391);const r={API_BASE_URL:"undefined"!==typeof window?window.location.origin:"",API_TIMEOUT:8e3,API_RETRY_TIMEOUT:12e3,CACHE_DURATION:18e4,CACHE_DURATION_OFFLINE:18e5,MAX_RETRIES:2,RETRY_DELAY:1e3,DEBOUNCE_DELAY:300,PREFETCH_NEXT_DAY:!0,DEBUG:!0},s=function(){if(r.DEBUG){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];console.log("[DEBUG]",...a)}},i=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];console.error("[ERROR]",...a)},l=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];console.warn("[WARN]",...a)};"undefined"!==typeof window&&(console.log("[CONFIG] Environment:","production"),console.log("[CONFIG] API Base URL:",r.API_BASE_URL),console.log("[CONFIG] Current Origin:",window.location.origin));var d=t(579);const c=()=>navigator.onLine,m="meeting_room_cache",p=e=>{if(!e)return 0;const a=e.split(":");return 60*(parseInt(a[0])||0)+(parseInt(a[1])||0)},u=e=>{let{isOpen:a,onClose:t,selectedSlot:o,onConfirm:r,preSelectedRoom:s="grande"}=e;const[i,l]=(0,n.useState)({name:"",title:"",participants:"",description:"",sala:s,start_time:"",end_time:""});(0,n.useEffect)((()=>{o&&a&&l((e=>({...e,sala:s,start_time:o.start_time,end_time:o.end_time})))}),[o,a,s]);return a&&o?(0,d.jsx)("div",{className:"modal-overlay",children:(0,d.jsxs)("div",{className:"modal-content",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h3",{children:"Agendar Reuni\xe3o"}),(0,d.jsx)("button",{className:"close-button",onClick:t,children:"\xd7"})]}),(0,d.jsxs)("div",{className:"booking-form",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Hor\xe1rio Selecionado"}),(0,d.jsxs)("div",{style:{padding:"0.8rem",background:"#e8f5e8",borderRadius:"8px",fontWeight:"600",color:"#2d5a3d"},children:[o.start_time," - ",o.end_time]})]}),(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i.name.trim()?i.title.trim()?i.start_time&&i.end_time?i.start_time>=i.end_time?alert("Hor\xe1rio de fim deve ser posterior ao hor\xe1rio de in\xedcio"):r({name:i.name.trim(),title:i.title.trim(),participants:i.participants.trim(),description:i.description.trim(),sala:i.sala,start_time:i.start_time,end_time:i.end_time}):alert("Hor\xe1rios s\xe3o obrigat\xf3rios"):alert("T\xedtulo da reuni\xe3o \xe9 obrigat\xf3rio"):alert("Nome \xe9 obrigat\xf3rio")},children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Nome do Respons\xe1vel *"}),(0,d.jsx)("input",{type:"text",value:i.name,onChange:e=>l((a=>({...a,name:e.target.value}))),required:!0,placeholder:"Digite seu nome"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"T\xedtulo da Reuni\xe3o *"}),(0,d.jsx)("input",{type:"text",value:i.title,onChange:e=>l((a=>({...a,title:e.target.value}))),required:!0,placeholder:"Ex: Reuni\xe3o de Vendas"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Participantes"}),(0,d.jsx)("textarea",{value:i.participants,onChange:e=>l((a=>({...a,participants:e.target.value}))),placeholder:"Lista de participantes (opcional)",rows:"3"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Descri\xe7\xe3o da Reuni\xe3o"}),(0,d.jsx)("textarea",{value:i.description,onChange:e=>l((a=>({...a,description:e.target.value}))),placeholder:"Descreva brevemente o assunto da reuni\xe3o (opcional)",rows:"2"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Sala de Reuni\xe3o *"}),(0,d.jsxs)("select",{value:i.sala,onChange:e=>l((a=>({...a,sala:e.target.value}))),required:!0,style:{width:"100%",padding:"0.8rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",backgroundColor:"#fff",cursor:"pointer"},children:[(0,d.jsx)("option",{value:"grande",children:"\ud83c\udfe2 Sala de Reuni\xe3o Grande"}),(0,d.jsx)("option",{value:"pequena",children:"\ud83c\udfe0 Sala de Reuni\xe3o Pequena"})]})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Hor\xe1rio de In\xedcio *"}),(0,d.jsx)("input",{type:"time",value:i.start_time,onChange:e=>l((a=>({...a,start_time:e.target.value}))),required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Hor\xe1rio de T\xe9rmino *"}),(0,d.jsx)("input",{type:"time",value:i.end_time,onChange:e=>l((a=>({...a,end_time:e.target.value}))),required:!0})]})]}),(0,d.jsxs)("div",{className:"form-actions",children:[(0,d.jsx)("button",{type:"button",onClick:t,className:"cancel-button",children:"Cancelar"}),(0,d.jsx)("button",{type:"submit",className:"submit-button",children:"Confirmar Agendamento"})]})]})]})]})}):null},g=()=>{const[e,a]=(0,n.useState)(new Date),[t,o]=(0,n.useState)("todas"),[g,h]=(0,n.useState)([]),[v,f]=(0,n.useState)(!1),[x,j]=(0,n.useState)(null),[_,E]=(0,n.useState)(null),[S,b]=(0,n.useState)({start_hour:8,end_hour:20,slot_duration:30}),{loading:y,error:N,request:w,setError:C}=(()=>{const[e,a]=(0,n.useState)(!1),[t,o]=(0,n.useState)(null),[d,c]=(0,n.useState)("online");(0,n.useEffect)((()=>{const e=()=>{c("online"),o(null)},a=()=>{c("offline"),o("Sem conex\xe3o com a internet")};return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}}),[]);const m=(0,n.useCallback)((async function(e){let a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.MAX_RETRIES;for(let d=0;d<i;d++)try{const t=0===d?r.API_TIMEOUT:r.API_RETRY_TIMEOUT;s(`Fazendo requisi\xe7\xe3o para: ${e} (tentativa ${d+1}/${i}) - timeout: ${t}ms`);const l=fetch(e,{...n,mode:"cors",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json",...n.headers}}),c=new Promise(((e,a)=>{setTimeout((()=>a(new Error(`Timeout de ${t}ms excedido`))),t)})),m=await Promise.race([l,c]);if(m.ok)return s(`Sucesso na requisi\xe7\xe3o para: ${e}`),o(null),m;if(m.status>=400&&m.status<500)throw new Error(`Erro ${m.status}: ${m.statusText}`);a=new Error(`Erro ${m.status}: ${m.statusText}`)}catch(t){if(a=t,t.message.includes("Timeout"),l(`Tentativa ${d+1}/${i} - ${t.message}`),d<i-1){const e=r.RETRY_DELAY*Math.pow(2,d);await new Promise((a=>setTimeout(a,e)))}}throw a}),[]),p=(0,n.useCallback)((async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(!0),o(null);try{const a=await m(e,n);return await a.json()}catch(t){throw i("Erro na requisi\xe7\xe3o:",t),o(t.message),t}finally{a(!1)}}),[m]);return{loading:e,error:t,request:p,fetchWithRetry:m,setError:o,setLoading:a,connectionStatus:d,isOnline:"online"===d}})(),R=e=>e.toISOString().split("T")[0],$=e=>{C(e)},A=(0,n.useMemo)((()=>{const{start_hour:e,end_hour:a,slot_duration:n}=S;return function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;const o=[];console.log("[DEBUG] Gerando slots com agendamentos:",e);for(let r=a;r<t;r++)for(let a=0;a<60;a+=n){const t=`${String(r).padStart(2,"0")}:${String(a).padStart(2,"0")}`,s=a+n;let i=r,l=s;s>=60&&(i++,l=s-60);const d=`${String(i).padStart(2,"0")}:${String(l).padStart(2,"0")}`,c=e.find((e=>{const a=p(t),n=p(d),o=p(e.start_time),r=p(e.end_time);console.log(`[DEBUG] Comparando slot ${t}-${d} (${a}-${n}) com agendamento ${e.start_time}-${e.end_time} (${o}-${r})`);const s=a>=o&&a<r||n>o&&n<=r||a<=o&&n>=r;return s&&console.log(`[DEBUG] \u2705 Conflito encontrado: slot ${t}-${d} ocupado por "${e.title}"`),s}));o.push({start_time:t,end_time:d,available:!c,appointment:c||null})}return console.log("[DEBUG] Slots gerados:",o.length,"total"),console.log("[DEBUG] Slots ocupados:",o.filter((e=>!e.available)).length),o}("todas"===t?g:g.filter((e=>e.sala===t)),e,a,n)}),[g,S,t]),T=(0,n.useCallback)((async()=>{const a=R(e);try{s(`Carregando configura\xe7\xe3o de slots para: ${a}`);const e=await w(`${r.API_BASE_URL}/api/availability/${a}`,{method:"GET"});e&&e.slots_config&&(b(e.slots_config),s("Configura\xe7\xe3o de slots atualizada:",e.slots_config))}catch(N){i("Erro ao carregar configura\xe7\xe3o de slots:",N)}}),[e,w]),D=(0,n.useCallback)((async()=>{const a=R(e),t=(e=>{try{const a=localStorage.getItem(`${m}_${e}`);if(a){const{data:e,timestamp:t}=JSON.parse(a),n=c()?r.CACHE_DURATION:r.CACHE_DURATION_OFFLINE;if(Date.now()-t<n)return e}}catch(a){console.warn("Erro ao ler cache:",a)}return null})(a);if(t)return h(t),void s("Dados carregados do cache para:",a);try{s(`Carregando agendamentos para: ${a}`);const e=await w(`${r.API_BASE_URL}/api/appointments?date=${a}`,{method:"GET"});s(`Dados recebidos para ${a}:`,e);const t=Array.isArray(e)?e:[];console.log("[DEBUG] Appointments processados:",t),h(t),((e,a)=>{try{localStorage.setItem(`${m}_${e}`,JSON.stringify({data:a,timestamp:Date.now()}))}catch(t){console.warn("Erro ao salvar cache:",t)}})(a,t)}catch(N){i("Erro ao carregar agendamentos:",N);const t=localStorage.getItem(`${m}_${a}`);if(t)try{const{data:e}=JSON.parse(t);h(e||[]),$("Usando dados em cache (pode estar desatualizado).")}catch{h([]),$("Erro de conex\xe3o. N\xe3o foi poss\xedvel carregar os dados.")}else h([]),$("Erro de conex\xe3o. Tente novamente.")}}),[e,w]);(0,n.useEffect)((()=>{T(),D()}),[T,D]),(0,n.useEffect)((()=>{console.log("Verificando acesso \xe0 imagem...")}),[]);const I=t=>{const n=new Date(e);n.setDate(n.getDate()+t),a(n)};return(0,d.jsxs)("div",{className:"app",children:[(0,d.jsx)("div",{className:"header",children:(0,d.jsx)("div",{className:"header-content",children:(0,d.jsxs)("div",{className:"logo-container",children:[(0,d.jsx)("img",{src:"/logo-belz.png",alt:"Belz Logo",className:"logo",onError:e=>{e.target.style.display="none"}}),(0,d.jsx)("h1",{children:"Agende sua Reuni\xe3o"})]})})}),(0,d.jsxs)("div",{className:"main-content",children:[!c()&&(0,d.jsx)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:"\u26a0\ufe0f Modo offline - Dados podem estar desatualizados"}),(0,d.jsxs)("div",{className:"date-navigation",children:[(0,d.jsx)("button",{className:"nav-button",onClick:()=>I(-1),disabled:y,children:"\u2039"}),(0,d.jsxs)("div",{className:"current-date",children:[(0,d.jsx)("h2",{children:(O=e,O.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}),(0,d.jsx)("input",{type:"date",value:R(e),onChange:e=>a(new Date(e.target.value+"T00:00:00")),style:{padding:"0.5rem",border:"2px solid #ddd",borderRadius:"8px",fontSize:"1rem"}})]}),(0,d.jsx)("button",{className:"nav-button",onClick:()=>I(1),disabled:y,children:"\u203a"})]}),(0,d.jsxs)("div",{style:{margin:"1rem 0",padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #ddd"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#333"},children:"Filtrar por Sala:"}),(0,d.jsxs)("select",{value:t,onChange:e=>o(e.target.value),style:{width:"100%",padding:"0.8rem",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"1rem",backgroundColor:"#fff",cursor:"pointer"},children:[(0,d.jsx)("option",{value:"todas",children:"\ud83c\udfe2\ud83c\udfe0 Todas as Salas"}),(0,d.jsx)("option",{value:"grande",children:"\ud83c\udfe2 Sala de Reuni\xe3o Grande"}),(0,d.jsx)("option",{value:"pequena",children:"\ud83c\udfe0 Sala de Reuni\xe3o Pequena"})]})]}),y&&(0,d.jsxs)("div",{className:"loading",children:[(0,d.jsx)("div",{className:"spinner"}),"Carregando agendamentos..."]}),N&&(0,d.jsxs)("div",{className:"notification error",style:{position:"relative",marginBottom:"1rem"},children:[(0,d.jsxs)("span",{children:["\u26a0\ufe0f ",N]}),(0,d.jsx)("button",{onClick:()=>C(null),children:"\xd7"})]}),_&&(0,d.jsx)("div",{className:"notification success",style:{position:"relative",marginBottom:"1rem"},children:(0,d.jsxs)("span",{children:["\u2705 ",_]})}),g.filter((e=>"todas"===t||e.sala===t)).length>0&&(0,d.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,d.jsxs)("h3",{style:{marginBottom:"1rem",color:"#2a5298"},children:["Agendamentos do Dia (",g.filter((e=>"todas"===t||e.sala===t)).length,")","todas"!==t&&(0,d.jsxs)("span",{style:{fontSize:"0.9rem",fontWeight:"normal",color:"#666",marginLeft:"0.5rem"},children:["- ","grande"===t?"Sala Grande":"Sala Pequena"]})]}),(0,d.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:g.filter((e=>"todas"===t||e.sala===t)).map((e=>(0,d.jsxs)("div",{style:{background:"white",padding:"1rem",borderRadius:"8px",border:"1px solid #ddd",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,d.jsx)("h4",{style:{margin:"0 0 0.5rem 0",color:"#2a5298"},children:e.title}),(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Hor\xe1rio:"})," ",e.start_time," - ",e.end_time]}),(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.name]}),e.participants&&(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Participantes:"})," ",e.participants]}),e.description&&(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",e.description]}),e.sala&&(0,d.jsxs)("p",{style:{margin:"0.25rem 0",fontSize:"0.9rem"},children:[(0,d.jsx)("strong",{children:"Sala:"})," ","grande"===e.sala?"\ud83c\udfe2 Sala Grande":"\ud83c\udfe0 Sala Pequena"]})]},e.id)))})]}),(0,d.jsx)("div",{className:"calendar-container",children:(0,d.jsx)("div",{className:"time-slots",children:A.map(((e,a)=>(0,d.jsxs)("div",{className:"time-slot "+(e.available?"available":"occupied"),onClick:()=>(e=>{e.available&&(j(e),f(!0))})(e),children:[(0,d.jsxs)("div",{className:"time-range",children:[e.start_time," - ",e.end_time]}),e.available?(0,d.jsx)("div",{className:"slot-status",children:"Dispon\xedvel"}):(0,d.jsxs)("div",{className:"appointment-info",children:[(0,d.jsx)("div",{className:"appointment-title",children:e.appointment.title}),(0,d.jsx)("div",{className:"appointment-name",children:e.appointment.name}),e.appointment.participants&&(0,d.jsxs)("div",{className:"appointment-participants",style:{fontSize:"0.8rem",color:"#666",marginTop:"0.2rem"},children:["\ud83d\udc65 ",e.appointment.participants]}),e.appointment.sala&&(0,d.jsx)("div",{className:"appointment-room",style:{fontSize:"0.8rem",color:"#666",marginTop:"0.2rem"},children:"grande"===e.appointment.sala?"\ud83c\udfe2 Sala Grande":"\ud83c\udfe0 Sala Pequena"})]})]},a)))})})]}),(0,d.jsx)(u,{isOpen:v,onClose:()=>{f(!1),j(null)},selectedSlot:x,onConfirm:async a=>{try{const n={name:a.name,title:a.title,participants:a.participants,description:a.description,sala:a.sala,date:R(e),start_time:a.start_time,end_time:a.end_time};s("Criando agendamento:",n),await w(`${r.API_BASE_URL}/api/appointments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),E("Agendamento criado com sucesso!"),setTimeout((()=>E(null)),3e3),f(!1),j(null);const o=R(e);localStorage.removeItem(`${m}_${o}`),console.log("[DEBUG] Recarregando agendamentos ap\xf3s cria\xe7\xe3o...");try{const e=Date.now(),a=await w(`${r.API_BASE_URL}/api/appointments?date=${o}&_cb=${e}`,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});console.log("[DEBUG] Dados frescos recebidos:",a);const t=Array.isArray(a)?a:[];h(t)}catch(t){console.error("[DEBUG] Erro ao recarregar, tentando m\xe9todo normal:",t),await D()}}catch(N){i("Erro ao criar agendamento:",N),$("Erro ao criar agendamento. Tente novamente.")}},preSelectedRoom:"todas"!==t?t:"grande"})]});var O};o.createRoot(document.getElementById("root")).render((0,d.jsx)(n.StrictMode,{children:(0,d.jsx)(g,{})}))}},a={};function t(n){var o=a[n];if(void 0!==o)return o.exports;var r=a[n]={exports:{}};return e[n](r,r.exports,t),r.exports}t.m=e,(()=>{var e=[];t.O=(a,n,o,r)=>{if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],o=e[c][1],r=e[c][2];for(var i=!0,l=0;l<n.length;l++)(!1&r||s>=r)&&Object.keys(t.O).every((e=>t.O[e](n[l])))?n.splice(l--,1):(i=!1,r<s&&(s=r));if(i){e.splice(c--,1);var d=o();void 0!==d&&(a=d)}}return a}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[n,o,r]}})(),t.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),(()=>{var e={792:0};t.O.j=a=>0===e[a];var a=(a,n)=>{var o,r,s=n[0],i=n[1],l=n[2],d=0;if(s.some((a=>0!==e[a]))){for(o in i)t.o(i,o)&&(t.m[o]=i[o]);if(l)var c=l(t)}for(a&&a(n);d<s.length;d++)r=s[d],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(c)},n=self.webpackChunkfrontend=self.webpackChunkfrontend||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))})();var n=t.O(void 0,[773],(()=>t(147)));n=t.O(n)})();
//# sourceMappingURL=main.f5b9a240.js.map